<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>MileStones - Movoto Development Style Documents</title>
        <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../css/highlight.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        <script src="../js/jquery-1.10.2.min.js"></script>
        <script src="../js/bootstrap-3.0.3.min.js"></script>
        <script src="../js/highlight.pack.js"></script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="..">Movoto Development Style Documents</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                    <li >
                        <a href="..">Home</a>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Style Guides <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../style-guides/source-code-style-guides/">Sources</a>
</li>
                            
<li >
    <a href="../style-guides/consensuses/">Consensuses</a>
</li>
                            
<li >
    <a href="../style-guides/git-flow/">Git Flow</a>
</li>
                            
<li >
    <a href="../style-guides/git-commit/">Git Commit</a>
</li>
                            
<li >
    <a href="../style-guides/design-patterns/">Design Patterns</a>
</li>
                        </ul>
                    </li>
                    <li class="active">
                        <a href="./">MileStones</a>
                    </li>
                </ul>

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                    <li >
                        <a rel="next" href="../style-guides/design-patterns/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li class="disabled">
                        <a rel="prev" >
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
            </ul>
        </div>
    </div>
</div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#tbd">优化计划（TBD）</a></li>
            <li><a href="#code-style">Code Style</a></li>
            <li><a href="#package-dependence">Package Dependence</a></li>
            <li><a href="#_3">按功能拆分</a></li>
            <li><a href="#_4">面向对象设计</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="tbd">优化计划（TBD）</h1>
<h2 id="code-style">Code Style</h2>
<p>首先安装配置好自动化 pep8 格式化插件，确保所有新提交或有新修改的代码文件都严格的符合 pep8 格式要求。</p>
<p>然后逐步的完善代码注释。</p>
<p>评估：</p>
<table>
<thead>
<tr>
<th align="left">是否影响线上</th>
<th align="left">对代码的影响</th>
<th align="left">对部署的影响</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">否</td>
<td align="left">小</td>
<td align="left">无</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="package-dependence">Package Dependence</h2>
<p>分为两大部分，分别是对依赖打包，和对项目自身打包。</p>
<h3 id="_1">对依赖打包</h3>
<p>首先可将 submodule 的依赖改为 package 形式，使用 pip 直接从 gitlab 安装。</p>
<p>这个的影响较小，但是线上的代码都需要重新安装一次（所以可以考虑和对项目打包一起做）。</p>
<p>需要：</p>
<ul>
<li>引入版本号机制；</li>
<li>修改每一个项目的 submodule；</li>
</ul>
<p>评估：</p>
<table>
<thead>
<tr>
<th align="left">是否影响线上</th>
<th align="left">对代码的影响</th>
<th align="left">对部署的影响</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">是</td>
<td align="left">改结构，不改接口和功能</td>
<td align="left">修改代码文件夹</td>
</tr>
</tbody>
</table>
<h3 id="_2">对项目打包</h3>
<p>我们现在的项目代码其实已经不仅仅是分别的脚本了，而是有独立的入口（如 run_task.py）,
有复杂的逻辑和依赖关系。</p>
<p>这种情况下应该将项目做成标准的包格式，编写属于自己的 requirements.txt，
如果是可执行的，就应该编写 <code>__main__.py</code> 或 <code>entry_point</code> 实现命令行的运行接口。</p>
<p>这么做的优点是：</p>
<ul>
<li>完善的版本管理；</li>
<li>清晰的程序执行入口；</li>
<li>易于安装；</li>
</ul>
<p>评估：</p>
<table>
<thead>
<tr>
<th align="left">是否影响线上</th>
<th align="left">对代码的影响</th>
<th align="left">对部署的影响</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">是</td>
<td align="left">改结构，不改接口和功能</td>
<td align="left">需要修改 crontab 的语句</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="_3">按功能拆分</h2>
<p>现在的代码文件过于平坦，可以按功能拆分为不同的文件夹，将代码分门别类的放好。</p>
<p>这是一步相当大的改动，需要在理解代码逻辑的情况下逐步的分拆整理。
建议在稳定的前提下，逐步的一点点的修改。</p>
<p>建议在熟练掌握 OOP 设计模式后，按照对象设计的理念进行拆分。</p>
<p>可以先拆分巨型函数为数个小函数，
然后再拆分一个过长的文件为几个小文件，将不同的功能逻辑放到不同的文件里，
最后再将功能类似的文件放到相同的文件夹中。</p>
<p>良好的拆分可以更为灵活的开发新功能，而且为引入单元测试提供了方便。</p>
<hr />
<h2 id="_4">面向对象设计</h2>
<p>考虑到目前前后游的逻辑关系越来越复杂，最好开始着手进行对象关系的设计，
不然命令式脚本的编程方法恐怕无法应付日益复杂的需求变化。</p>
<p>在面对新需求时，在开始考虑业务代码实现以前，最好稍微多花一些时间讨论一下整体的逻辑设计。
业务虽然重要，但是必要的程序设计可以更好的服务业务。</p></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>var base_url = '..';</script>
        <script src="../js/base.js"></script>
        <script src="../search/require.js"></script>
        <script src="../search/search.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td><kbd>&larr;</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td><kbd>&rarr;</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>


    </body>
</html>
